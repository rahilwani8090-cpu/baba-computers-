<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Filo ‚Äî Smart File Organizer</title>
<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800;900&family=DM+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
/* ===== DESIGN TOKENS ===== */
:root {
  --sapphire: #1A1F5E;
  --indigo: #5C6BC0;
  --indigo-light: #7986CB;
  --lime: #C6F135;
  --lime-dark: #A5D106;
  --surface: #0B0E1F;
  --surface-1: #111428;
  --surface-2: #181D36;
  --surface-3: #1F2547;
  --surface-4: #252C54;
  --on-surface: #EEEEFF;
  --on-surface-2: #9BA3D4;
  --on-surface-3: #5C6490;
  --success: #69F0AE;
  --warning: #FFD740;
  --error: #FF5252;
  --info: #40C4FF;
  --cat-electric: #FFB300;
  --cat-water: #0288D1;
  --cat-bank: #2E7D32;
  --cat-medical: #D32F2F;
  --cat-invoice: #6A1B9A;
  --cat-receipt: #00695C;
  --cat-salary: #283593;
  --cat-tax: #C62828;
  --cat-insurance: #37474F;
  --cat-id: #4527A0;
  --cat-academic: #00838F;
  --cat-legal: #827717;
  --cat-image: #E91E63;
  --cat-video: #F4511E;
  --cat-audio: #00897B;
  --cat-apk: #546E7A;
  --cat-other: #455A64;
  --r-sm: 10px;
  --r-md: 16px;
  --r-lg: 22px;
  --r-xl: 28px;
  --r-2xl: 36px;
  --font-display: 'Outfit', sans-serif;
  --font-body: 'DM Sans', sans-serif;
  --shadow-glow: 0 0 30px rgba(92,107,192,0.25);
  --shadow-card: 0 4px 24px rgba(0,0,0,0.4);
  --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

/* ===== RESET ===== */
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
html, body { height: 100%; overflow: hidden; background: #050710; font-family: var(--font-body); }

/* ===== PHONE FRAME ===== */
.phone-wrapper {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 100vw;
  height: 100vh;
  background: radial-gradient(ellipse 80% 60% at 50% 50%, #1a1f5e22, transparent),
              radial-gradient(ellipse 40% 40% at 20% 80%, #5c6bc011, transparent),
              #050710;
}

.phone-frame {
  width: 390px;
  height: 844px;
  background: var(--surface);
  border-radius: 50px;
  overflow: hidden;
  position: relative;
  box-shadow: 
    0 0 0 1px rgba(255,255,255,0.08),
    0 30px 80px rgba(0,0,0,0.8),
    0 0 60px rgba(92,107,192,0.15),
    inset 0 1px 0 rgba(255,255,255,0.05);
  display: flex;
  flex-direction: column;
}

/* Status bar */
.status-bar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 14px 28px 8px;
  font-family: var(--font-display);
  font-size: 13px;
  font-weight: 600;
  color: var(--on-surface);
  flex-shrink: 0;
  position: relative;
  z-index: 10;
}
.status-bar .notch {
  position: absolute;
  top: 0; left: 50%;
  transform: translateX(-50%);
  width: 126px; height: 34px;
  background: #000;
  border-radius: 0 0 22px 22px;
}
.status-icons { display: flex; gap: 6px; align-items: center; }
.status-icons svg { width: 16px; height: 16px; }

/* App container */
.app {
  flex: 1;
  overflow: hidden;
  position: relative;
}

/* ===== SCREENS ===== */
.screen {
  position: absolute;
  inset: 0;
  overflow-y: auto;
  overflow-x: hidden;
  background: var(--surface);
  scrollbar-width: none;
  -webkit-overflow-scrolling: touch;
  display: none;
  flex-direction: column;
}
.screen::-webkit-scrollbar { display: none; }
.screen.active {
  display: flex;
  animation: screenIn 0.35s cubic-bezier(0.4,0,0.2,1) both;
}
.screen.slide-back {
  animation: screenBack 0.35s cubic-bezier(0.4,0,0.2,1) both;
}

@keyframes screenIn {
  from { opacity: 0; transform: translateX(40px); }
  to { opacity: 1; transform: translateX(0); }
}
@keyframes screenBack {
  from { opacity: 0; transform: translateX(-40px); }
  to { opacity: 1; transform: translateX(0); }
}

/* ===== SPLASH SCREEN ===== */
#splash {
  background: var(--surface);
  align-items: center;
  justify-content: center;
  gap: 0;
}
.splash-bg {
  position: absolute;
  inset: 0;
  overflow: hidden;
}
.splash-blob {
  position: absolute;
  border-radius: 50%;
  filter: blur(60px);
  animation: blobPulse 4s ease-in-out infinite alternate;
}
.blob1 { width: 300px; height: 300px; background: rgba(92,107,192,0.25); top: -80px; right: -80px; animation-delay: 0s; }
.blob2 { width: 250px; height: 250px; background: rgba(26,31,94,0.4); bottom: 50px; left: -60px; animation-delay: 1.5s; }
.blob3 { width: 180px; height: 180px; background: rgba(198,241,53,0.08); top: 50%; left: 50%; transform: translate(-50%,-50%); animation-delay: 0.8s; }

@keyframes blobPulse {
  from { transform: scale(1) translate(0,0); }
  to { transform: scale(1.2) translate(10px,-10px); }
}
.blob3 { animation: blobPulse3 4s ease-in-out infinite alternate; }
@keyframes blobPulse3 {
  from { transform: translate(-50%,-50%) scale(1); }
  to { transform: translate(-50%,-50%) scale(1.3); }
}

.splash-content {
  position: relative;
  z-index: 2;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 20px;
  animation: splashReveal 0.8s cubic-bezier(0.34,1.56,0.64,1) 0.3s both;
}
@keyframes splashReveal {
  from { opacity: 0; transform: scale(0.7); }
  to { opacity: 1; transform: scale(1); }
}

.splash-logo {
  width: 90px; height: 90px;
  background: linear-gradient(135deg, var(--indigo), #8C9EFF);
  border-radius: 26px;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 20px 50px rgba(92,107,192,0.5), 0 0 0 1px rgba(255,255,255,0.1);
  position: relative;
  overflow: hidden;
}
.splash-logo::after {
  content: '';
  position: absolute;
  top: -50%; left: -50%;
  width: 200%; height: 200%;
  background: linear-gradient(45deg, transparent, rgba(255,255,255,0.15), transparent);
  animation: shimmer 2s ease-in-out infinite;
}
@keyframes shimmer {
  0% { transform: translateX(-100%) rotate(45deg); }
  100% { transform: translateX(100%) rotate(45deg); }
}
.splash-logo svg { width: 48px; height: 48px; }

.splash-wordmark {
  font-family: var(--font-display);
  font-size: 46px;
  font-weight: 800;
  color: var(--on-surface);
  letter-spacing: -2px;
  animation: splashReveal 0.8s cubic-bezier(0.34,1.56,0.64,1) 0.5s both;
}
.splash-wordmark span { color: var(--lime); }

.splash-tagline {
  font-family: var(--font-body);
  font-size: 15px;
  color: var(--on-surface-2);
  letter-spacing: 0.3px;
  animation: splashReveal 0.8s ease 0.7s both;
}

.splash-scan-line {
  position: absolute;
  width: 100%;
  height: 2px;
  background: linear-gradient(90deg, transparent, var(--lime), transparent);
  animation: scanLine 1.2s ease-in-out 1s both;
}
@keyframes scanLine {
  from { top: -2px; opacity: 0; }
  20% { opacity: 1; }
  to { top: calc(100% + 2px); opacity: 0; }
}

.splash-powered {
  position: absolute;
  bottom: 40px;
  font-family: var(--font-body);
  font-size: 12px;
  color: var(--on-surface-3);
  animation: fadeIn 0.5s ease 1.5s both;
  letter-spacing: 0.5px;
}

/* ===== ONBOARDING ===== */
#onboarding {
  background: var(--surface);
}
.onboarding-pager {
  display: flex;
  overflow: hidden;
  flex: 1;
}
.onboard-page {
  min-width: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 20px 28px 0;
  transition: transform 0.4s cubic-bezier(0.4,0,0.2,1);
}
.onboard-illustration {
  width: 220px; height: 220px;
  margin: 20px auto;
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
}
.onboard-icon-wrap {
  width: 160px; height: 160px;
  background: var(--surface-2);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
  border: 1px solid rgba(255,255,255,0.06);
  animation: floatAnim 3s ease-in-out infinite;
}
@keyframes floatAnim {
  0%,100% { transform: translateY(0); }
  50% { transform: translateY(-10px); }
}
.onboard-icon-wrap svg { width: 80px; height: 80px; }
.onboard-ring {
  position: absolute;
  border-radius: 50%;
  border: 1px solid rgba(92,107,192,0.3);
  animation: ringPulse 2s ease-out infinite;
}
.ring1 { width: 180px; height: 180px; animation-delay: 0s; }
.ring2 { width: 210px; height: 210px; animation-delay: 0.5s; }
@keyframes ringPulse {
  0% { transform: scale(0.9); opacity: 0.8; }
  100% { transform: scale(1.1); opacity: 0; }
}

.onboard-tag {
  font-family: var(--font-display);
  font-size: 11px;
  font-weight: 600;
  letter-spacing: 1.5px;
  text-transform: uppercase;
  color: var(--lime);
  margin-bottom: 12px;
}
.onboard-title {
  font-family: var(--font-display);
  font-size: 28px;
  font-weight: 800;
  color: var(--on-surface);
  text-align: center;
  line-height: 1.2;
  margin-bottom: 14px;
}
.onboard-subtitle {
  font-size: 15px;
  color: var(--on-surface-2);
  text-align: center;
  line-height: 1.6;
}

.onboard-dots {
  display: flex;
  gap: 8px;
  justify-content: center;
  padding: 24px 0 16px;
}
.dot {
  width: 8px; height: 8px;
  border-radius: 4px;
  background: var(--surface-4);
  transition: all 0.3s ease;
}
.dot.active {
  width: 24px;
  background: var(--lime);
}

.onboard-footer {
  padding: 0 28px 36px;
  display: flex;
  flex-direction: column;
  gap: 12px;
}

/* ===== BUTTONS ===== */
.btn {
  width: 100%;
  padding: 16px;
  border: none;
  border-radius: var(--r-md);
  font-family: var(--font-display);
  font-size: 16px;
  font-weight: 600;
  cursor: pointer;
  transition: var(--transition);
  letter-spacing: 0.3px;
}
.btn:active { transform: scale(0.97); }
.btn-primary {
  background: var(--lime);
  color: var(--sapphire);
}
.btn-primary:hover { background: var(--lime-dark); }
.btn-outline {
  background: transparent;
  color: var(--on-surface);
  border: 1px solid var(--surface-4);
}
.btn-outline:hover { background: var(--surface-2); }
.btn-ghost {
  background: transparent;
  color: var(--on-surface-2);
  padding: 10px;
  width: auto;
}

/* ===== BOTTOM NAV ===== */
.bottom-nav {
  display: flex;
  background: var(--surface-2);
  border-top: 1px solid rgba(255,255,255,0.05);
  padding: 8px 0 12px;
  flex-shrink: 0;
  position: relative;
  z-index: 100;
}
.nav-item {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 4px;
  padding: 8px 0 4px;
  cursor: pointer;
  position: relative;
  transition: var(--transition);
}
.nav-item svg { width: 22px; height: 22px; color: var(--on-surface-3); transition: var(--transition); }
.nav-item span { font-family: var(--font-body); font-size: 10px; color: var(--on-surface-3); transition: var(--transition); }
.nav-item.active svg { color: var(--lime); }
.nav-item.active span { color: var(--lime); }
.nav-indicator {
  position: absolute;
  bottom: -4px;
  width: 4px; height: 4px;
  background: var(--lime);
  border-radius: 50%;
  opacity: 0;
  transition: var(--transition);
}
.nav-item.active .nav-indicator { opacity: 1; }
.nav-badge {
  position: absolute;
  top: 4px; right: 50%;
  transform: translateX(10px);
  background: var(--error);
  color: white;
  font-size: 9px;
  font-weight: 700;
  min-width: 16px; height: 16px;
  border-radius: 8px;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0 4px;
  border: 2px solid var(--surface-2);
}

/* ===== MAIN LAYOUT ===== */
#main-app {
  display: none;
  flex-direction: column;
  height: 100%;
}
#main-app.active {
  display: flex;
  animation: screenIn 0.4s ease both;
}
.main-content {
  flex: 1;
  overflow: hidden;
  position: relative;
}
.tab-screen {
  position: absolute;
  inset: 0;
  overflow-y: auto;
  overflow-x: hidden;
  scrollbar-width: none;
  display: none;
  flex-direction: column;
}
.tab-screen::-webkit-scrollbar { display: none; }
.tab-screen.active {
  display: flex;
  animation: fadeUp 0.35s ease both;
}
@keyframes fadeUp {
  from { opacity: 0; transform: translateY(12px); }
  to { opacity: 1; transform: translateY(0); }
}

/* ===== DASHBOARD ===== */
.dash-header {
  padding: 20px 20px 12px;
  background: var(--surface);
  flex-shrink: 0;
}
.dash-top {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 20px;
}
.greeting-sub { font-size: 12px; color: var(--on-surface-3); margin-bottom: 2px; }
.greeting-main { font-family: var(--font-display); font-size: 24px; font-weight: 800; color: var(--on-surface); }
.dash-actions { display: flex; gap: 8px; align-items: center; }

.scan-badge {
  display: flex;
  align-items: center;
  gap: 6px;
  background: rgba(198,241,53,0.1);
  border: 1px solid rgba(198,241,53,0.2);
  border-radius: 20px;
  padding: 6px 12px;
  font-size: 12px;
  font-weight: 600;
  color: var(--lime);
  font-family: var(--font-display);
}
.scan-pulse {
  width: 8px; height: 8px;
  background: var(--lime);
  border-radius: 50%;
  animation: pulse 1.5s ease-in-out infinite;
}
@keyframes pulse {
  0%,100% { transform: scale(1); opacity: 1; }
  50% { transform: scale(1.4); opacity: 0.6; }
}
.scan-badge.idle { background: rgba(91,95,144,0.15); border-color: rgba(91,95,144,0.2); color: var(--on-surface-3); }
.scan-badge.idle .scan-pulse { background: var(--on-surface-3); animation: none; }

.settings-btn {
  width: 38px; height: 38px;
  background: var(--surface-2);
  border-radius: 12px;
  border: none;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: var(--transition);
  border: 1px solid rgba(255,255,255,0.05);
}
.settings-btn:hover { background: var(--surface-3); }
.settings-btn svg { width: 20px; height: 20px; color: var(--on-surface-2); }

/* Stats strip */
.stats-strip {
  display: flex;
  gap: 10px;
  overflow-x: auto;
  padding-bottom: 4px;
  scrollbar-width: none;
}
.stats-strip::-webkit-scrollbar { display: none; }

.stat-card {
  flex-shrink: 0;
  background: var(--surface-2);
  border: 1px solid rgba(255,255,255,0.05);
  border-radius: var(--r-md);
  padding: 14px 16px;
  display: flex;
  align-items: center;
  gap: 12px;
  min-width: 140px;
}
.stat-icon {
  width: 36px; height: 36px;
  border-radius: 10px;
  display: flex;
  align-items: center;
  justify-content: center;
}
.stat-icon svg { width: 18px; height: 18px; }
.stat-num {
  font-family: var(--font-display);
  font-size: 22px;
  font-weight: 800;
  color: var(--on-surface);
  line-height: 1;
}
.stat-label { font-size: 11px; color: var(--on-surface-3); margin-top: 2px; }

/* Section headers */
.section-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 20px 20px 10px;
}
.section-title { font-family: var(--font-display); font-size: 17px; font-weight: 700; color: var(--on-surface); }
.section-link { font-size: 13px; color: var(--indigo-light); cursor: pointer; font-weight: 500; }

/* Activity Feed */
.activity-list { padding: 0 20px; display: flex; flex-direction: column; gap: 10px; }
.file-card {
  background: var(--surface-2);
  border: 1px solid rgba(255,255,255,0.05);
  border-radius: var(--r-md);
  padding: 14px;
  display: flex;
  align-items: center;
  gap: 12px;
  cursor: pointer;
  transition: var(--transition);
  position: relative;
  overflow: hidden;
  animation: cardSlideIn 0.4s cubic-bezier(0.34,1.56,0.64,1) both;
}
.file-card:hover { background: var(--surface-3); transform: translateY(-1px); }
.file-card::before {
  content: '';
  position: absolute;
  left: 0; top: 0; bottom: 0;
  width: 3px;
  border-radius: 3px 0 0 3px;
}
@keyframes cardSlideIn {
  from { opacity: 0; transform: translateX(30px); }
  to { opacity: 1; transform: translateX(0); }
}

.file-icon-wrap {
  width: 44px; height: 44px;
  border-radius: 12px;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
  font-size: 22px;
}
.file-info { flex: 1; min-width: 0; }
.file-name {
  font-family: var(--font-display);
  font-size: 14px;
  font-weight: 600;
  color: var(--on-surface);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.file-original { font-size: 11px; color: var(--on-surface-3); margin-top: 2px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.file-meta { display: flex; align-items: center; gap: 6px; margin-top: 6px; }
.file-badge {
  font-size: 10px;
  font-weight: 600;
  padding: 2px 8px;
  border-radius: 6px;
  font-family: var(--font-display);
}
.file-time { font-size: 11px; color: var(--on-surface-3); margin-left: auto; align-self: flex-start; flex-shrink: 0; }

/* OCR indicator */
.ocr-bar {
  width: 100%;
  height: 3px;
  background: rgba(255,255,255,0.05);
  border-radius: 3px;
  margin-top: 8px;
  overflow: hidden;
}
.ocr-fill {
  height: 100%;
  border-radius: 3px;
  background: linear-gradient(90deg, var(--indigo), var(--lime));
  transition: width 1s ease;
}

/* Category grid */
.cat-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 10px;
  padding: 0 20px 24px;
}
.cat-mini {
  background: var(--surface-2);
  border-radius: var(--r-md);
  padding: 16px;
  cursor: pointer;
  border: 1px solid rgba(255,255,255,0.05);
  transition: var(--transition);
  position: relative;
  overflow: hidden;
}
.cat-mini:hover { transform: scale(0.98); }
.cat-mini::after {
  content: '';
  position: absolute;
  inset: 0;
  background: linear-gradient(135deg, var(--accent-color, var(--indigo))22, transparent);
  pointer-events: none;
}
.cat-mini-icon { font-size: 28px; margin-bottom: 10px; display: block; }
.cat-mini-name { font-family: var(--font-display); font-size: 13px; font-weight: 700; color: var(--on-surface); margin-bottom: 4px; }
.cat-mini-count { font-size: 12px; color: var(--on-surface-3); }

/* ===== CATEGORIES SCREEN ===== */
.cat-screen-header {
  padding: 20px 20px 0;
  flex-shrink: 0;
}
.screen-title { font-family: var(--font-display); font-size: 28px; font-weight: 800; color: var(--on-surface); margin-bottom: 4px; }
.screen-sub { font-size: 14px; color: var(--on-surface-3); }

.cat-full-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 10px;
  padding: 16px 20px 24px;
}
.cat-full-card {
  background: var(--surface-2);
  border-radius: var(--r-lg);
  padding: 18px;
  cursor: pointer;
  border: 1px solid rgba(255,255,255,0.05);
  transition: var(--transition);
  position: relative;
  overflow: hidden;
  animation: cardFadeIn 0.4s ease both;
}
.cat-full-card:nth-child(2n) { animation-delay: 0.05s; }
.cat-full-card:hover { transform: scale(0.97); box-shadow: var(--shadow-card); }
@keyframes cardFadeIn {
  from { opacity: 0; transform: scale(0.9); }
  to { opacity: 1; transform: scale(1); }
}
.cat-card-bg {
  position: absolute;
  inset: 0;
  opacity: 0.12;
  border-radius: inherit;
}
.cat-card-icon-wrap {
  width: 52px; height: 52px;
  border-radius: 16px;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-bottom: 14px;
  font-size: 26px;
  position: relative;
}
.cat-card-name {
  font-family: var(--font-display);
  font-size: 14px;
  font-weight: 700;
  color: var(--on-surface);
  margin-bottom: 4px;
}
.cat-card-count {
  font-size: 12px;
  color: var(--on-surface-3);
  display: flex;
  align-items: center;
  gap: 4px;
}
.cat-card-size {
  position: absolute;
  top: 16px; right: 16px;
  font-size: 11px;
  font-weight: 600;
  color: var(--on-surface-2);
  font-family: var(--font-display);
}

/* ===== FILE LIST SCREEN ===== */
.detail-screen {
  position: absolute;
  inset: 0;
  background: var(--surface);
  z-index: 200;
  display: none;
  flex-direction: column;
  animation: screenIn 0.35s ease both;
}
.detail-screen.active { display: flex; }

.detail-header {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 16px 20px;
  flex-shrink: 0;
  border-bottom: 1px solid rgba(255,255,255,0.05);
}
.back-btn {
  width: 38px; height: 38px;
  background: var(--surface-2);
  border: 1px solid rgba(255,255,255,0.06);
  border-radius: 12px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  flex-shrink: 0;
  transition: var(--transition);
}
.back-btn:hover { background: var(--surface-3); }
.back-btn svg { width: 20px; height: 20px; color: var(--on-surface-2); }
.detail-header-title { font-family: var(--font-display); font-size: 18px; font-weight: 700; color: var(--on-surface); }
.detail-header-sub { font-size: 12px; color: var(--on-surface-3); margin-top: 1px; }

.file-list-body { flex: 1; overflow-y: auto; padding: 12px 16px 20px; display: flex; flex-direction: column; gap: 8px; }
.file-list-body::-webkit-scrollbar { display: none; }

.file-list-item {
  background: var(--surface-2);
  border-radius: var(--r-md);
  padding: 14px;
  display: flex;
  align-items: center;
  gap: 12px;
  cursor: pointer;
  border: 1px solid rgba(255,255,255,0.05);
  transition: var(--transition);
  animation: cardSlideIn 0.4s cubic-bezier(0.34,1.56,0.64,1) both;
}
.file-list-item:hover { background: var(--surface-3); }

/* ===== SEARCH SCREEN ===== */
.search-header { padding: 20px 20px 12px; flex-shrink: 0; }
.search-input-wrap {
  display: flex;
  align-items: center;
  background: var(--surface-2);
  border: 1px solid rgba(255,255,255,0.08);
  border-radius: var(--r-md);
  padding: 0 14px;
  gap: 10px;
  margin-top: 14px;
  transition: var(--transition);
}
.search-input-wrap:focus-within {
  border-color: var(--indigo);
  box-shadow: 0 0 0 3px rgba(92,107,192,0.15);
}
.search-input-wrap svg { width: 20px; height: 20px; color: var(--on-surface-3); flex-shrink: 0; }
.search-input {
  flex: 1;
  background: none;
  border: none;
  outline: none;
  color: var(--on-surface);
  font-family: var(--font-body);
  font-size: 15px;
  padding: 14px 0;
}
.search-input::placeholder { color: var(--on-surface-3); }

.filter-chips {
  display: flex;
  gap: 8px;
  overflow-x: auto;
  padding: 0 20px 16px;
  scrollbar-width: none;
}
.filter-chips::-webkit-scrollbar { display: none; }
.chip {
  flex-shrink: 0;
  padding: 6px 14px;
  border-radius: 20px;
  font-size: 12px;
  font-weight: 600;
  font-family: var(--font-display);
  cursor: pointer;
  border: 1px solid rgba(255,255,255,0.08);
  background: var(--surface-2);
  color: var(--on-surface-2);
  transition: var(--transition);
}
.chip.active {
  background: rgba(92,107,192,0.2);
  border-color: var(--indigo);
  color: var(--indigo-light);
}

/* ===== STATS SCREEN ===== */
.stats-header { padding: 20px 20px 0; flex-shrink: 0; }
.donut-wrap {
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 20px;
}
.donut-chart {
  position: relative;
  width: 200px; height: 200px;
}
.donut-chart svg { width: 100%; height: 100%; transform: rotate(-90deg); }
.donut-center {
  position: absolute;
  inset: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
}
.donut-center-num { font-family: var(--font-display); font-size: 32px; font-weight: 800; color: var(--on-surface); }
.donut-center-label { font-size: 12px; color: var(--on-surface-3); }
.donut-legend { display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; margin-top: 16px; }
.legend-item { display: flex; align-items: center; gap: 6px; font-size: 12px; color: var(--on-surface-2); }
.legend-dot { width: 10px; height: 10px; border-radius: 50%; flex-shrink: 0; }

.bar-chart { padding: 0 20px 20px; display: flex; flex-direction: column; gap: 12px; }
.bar-row { display: flex; align-items: center; gap: 12px; }
.bar-label { font-size: 12px; color: var(--on-surface-2); width: 90px; flex-shrink: 0; text-align: right; }
.bar-track { flex: 1; height: 10px; background: var(--surface-3); border-radius: 6px; overflow: hidden; }
.bar-fill { height: 100%; border-radius: 6px; transition: width 1.2s cubic-bezier(0.4,0,0.2,1); }
.bar-count { font-size: 12px; color: var(--on-surface-3); width: 30px; flex-shrink: 0; font-family: var(--font-display); font-weight: 600; }

/* ===== SETTINGS SCREEN ===== */
.settings-body { flex: 1; overflow-y: auto; padding: 0 0 20px; scrollbar-width: none; }
.settings-body::-webkit-scrollbar { display: none; }
.settings-section { margin-bottom: 4px; }
.settings-section-title { font-size: 11px; font-weight: 700; letter-spacing: 1.2px; text-transform: uppercase; color: var(--on-surface-3); padding: 16px 20px 8px; }
.settings-item {
  display: flex;
  align-items: center;
  gap: 14px;
  padding: 14px 20px;
  background: var(--surface-2);
  border-bottom: 1px solid rgba(255,255,255,0.03);
  cursor: pointer;
  transition: var(--transition);
}
.settings-item:first-of-type { border-top: 1px solid rgba(255,255,255,0.03); }
.settings-item:hover { background: var(--surface-3); }
.settings-item-icon {
  width: 38px; height: 38px;
  border-radius: 11px;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}
.settings-item-icon svg { width: 20px; height: 20px; }
.settings-item-info { flex: 1; }
.settings-item-name { font-family: var(--font-display); font-size: 15px; font-weight: 600; color: var(--on-surface); }
.settings-item-desc { font-size: 12px; color: var(--on-surface-3); margin-top: 2px; }
.settings-item-right { flex-shrink: 0; }

/* Toggle */
.toggle {
  width: 46px; height: 26px;
  background: var(--surface-4);
  border-radius: 13px;
  position: relative;
  cursor: pointer;
  transition: background 0.3s ease;
  border: none;
  outline: none;
}
.toggle.on { background: var(--lime); }
.toggle-thumb {
  position: absolute;
  top: 3px; left: 3px;
  width: 20px; height: 20px;
  background: white;
  border-radius: 50%;
  transition: transform 0.3s cubic-bezier(0.34,1.56,0.64,1);
  box-shadow: 0 2px 6px rgba(0,0,0,0.3);
}
.toggle.on .toggle-thumb { transform: translateX(20px); }

/* ===== FILE DETAIL POPUP ===== */
#file-detail-popup {
  position: absolute;
  inset: 0;
  z-index: 300;
  display: none;
  flex-direction: column;
  background: var(--surface);
}
#file-detail-popup.active {
  display: flex;
  animation: screenIn 0.35s ease both;
}
.file-preview-hero {
  height: 200px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 80px;
  position: relative;
  overflow: hidden;
  flex-shrink: 0;
}
.file-preview-hero::after {
  content: '';
  position: absolute;
  bottom: 0; left: 0; right: 0;
  height: 80px;
  background: linear-gradient(to bottom, transparent, var(--surface));
}
.file-detail-body { flex: 1; overflow-y: auto; padding: 0 20px 20px; scrollbar-width: none; }
.file-detail-body::-webkit-scrollbar { display: none; }
.detail-info-card { background: var(--surface-2); border-radius: var(--r-md); padding: 16px; margin-bottom: 12px; border: 1px solid rgba(255,255,255,0.05); }
.detail-info-label { font-size: 11px; color: var(--on-surface-3); font-weight: 600; letter-spacing: 0.8px; text-transform: uppercase; margin-bottom: 4px; }
.detail-info-value { font-family: var(--font-display); font-size: 15px; color: var(--on-surface); font-weight: 600; }
.ocr-text-block {
  background: var(--surface-3);
  border-radius: var(--r-sm);
  padding: 12px;
  font-size: 12px;
  line-height: 1.7;
  color: var(--on-surface-2);
  font-family: 'Courier New', monospace;
  border-left: 3px solid var(--indigo);
  max-height: 120px;
  overflow-y: auto;
}
.ocr-keyword { color: var(--lime); font-weight: 700; }
.path-arrow { display: flex; align-items: center; gap: 8px; font-size: 12px; }
.path-old { color: var(--error); text-decoration: line-through; opacity: 0.7; word-break: break-all; }
.path-new { color: var(--success); word-break: break-all; }
.action-row { display: flex; gap: 10px; margin-top: 12px; }
.action-btn {
  flex: 1;
  padding: 12px;
  border-radius: var(--r-sm);
  border: none;
  cursor: pointer;
  font-family: var(--font-display);
  font-size: 13px;
  font-weight: 600;
  transition: var(--transition);
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
}
.action-btn:active { transform: scale(0.96); }
.action-btn svg { width: 16px; height: 16px; }

/* ===== SCANNING OVERLAY ===== */
.scanning-overlay {
  position: absolute;
  inset: 0;
  background: rgba(11,14,31,0.95);
  z-index: 500;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 20px;
  display: none;
}
.scanning-overlay.active { display: flex; }
.scan-ring {
  width: 120px; height: 120px;
  border-radius: 50%;
  border: 3px solid rgba(92,107,192,0.2);
  border-top-color: var(--indigo);
  animation: spin 1s linear infinite;
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
}
@keyframes spin { to { transform: rotate(360deg); } }
.scan-ring-inner {
  width: 80px; height: 80px;
  border-radius: 50%;
  border: 2px solid rgba(198,241,53,0.2);
  border-bottom-color: var(--lime);
  animation: spin 0.7s linear infinite reverse;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 30px;
}
.scan-title { font-family: var(--font-display); font-size: 18px; font-weight: 700; color: var(--on-surface); }
.scan-sub { font-size: 13px; color: var(--on-surface-2); text-align: center; padding: 0 40px; }
.scan-progress-wrap { width: 200px; }
.scan-progress-bar { height: 4px; background: var(--surface-3); border-radius: 4px; overflow: hidden; margin-top: 8px; }
.scan-progress-fill { height: 100%; background: linear-gradient(90deg, var(--indigo), var(--lime)); border-radius: 4px; width: 0; transition: width 0.3s ease; }
.scan-step { font-size: 12px; color: var(--on-surface-3); text-align: center; }

/* ===== TOAST ===== */
.toast {
  position: absolute;
  bottom: 80px;
  left: 16px; right: 16px;
  background: var(--surface-3);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: var(--r-md);
  padding: 14px 16px;
  display: flex;
  align-items: center;
  gap: 12px;
  z-index: 999;
  transform: translateY(100px);
  opacity: 0;
  transition: all 0.4s cubic-bezier(0.34,1.56,0.64,1);
  box-shadow: var(--shadow-card);
}
.toast.show { transform: translateY(0); opacity: 1; }
.toast-icon { width: 36px; height: 36px; border-radius: 10px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; font-size: 18px; }
.toast-text { flex: 1; }
.toast-title { font-family: var(--font-display); font-size: 14px; font-weight: 600; color: var(--on-surface); }
.toast-sub { font-size: 12px; color: var(--on-surface-3); margin-top: 2px; }
.toast-undo { font-size: 13px; font-weight: 600; color: var(--lime); cursor: pointer; flex-shrink: 0; }

/* ===== FAB ===== */
.fab {
  position: absolute;
  bottom: 16px;
  right: 16px;
  background: var(--lime);
  border: none;
  border-radius: 20px;
  padding: 14px 20px;
  display: flex;
  align-items: center;
  gap: 8px;
  font-family: var(--font-display);
  font-size: 14px;
  font-weight: 700;
  color: var(--sapphire);
  cursor: pointer;
  box-shadow: 0 8px 24px rgba(198,241,53,0.3);
  transition: var(--transition);
  z-index: 50;
}
.fab:hover { transform: translateY(-2px); box-shadow: 0 12px 32px rgba(198,241,53,0.4); }
.fab:active { transform: scale(0.96); }
.fab svg { width: 18px; height: 18px; }

/* ===== UTILITIES ===== */
.fade-in { animation: fadeIn 0.4s ease both; }
@keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

.divider { height: 1px; background: rgba(255,255,255,0.04); margin: 8px 0; }
.empty-state { display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 60px 40px; text-align: center; gap: 12px; }
.empty-icon { font-size: 48px; opacity: 0.5; }
.empty-title { font-family: var(--font-display); font-size: 18px; font-weight: 700; color: var(--on-surface-2); }
.empty-sub { font-size: 13px; color: var(--on-surface-3); line-height: 1.6; }

.tag {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 4px 10px;
  border-radius: 8px;
  font-size: 11px;
  font-weight: 600;
  font-family: var(--font-display);
}

.scroll-end { height: 20px; flex-shrink: 0; }
</style>
</head>
<body>
<div class="phone-wrapper">
  <div class="phone-frame">
    <!-- STATUS BAR -->
    <div class="status-bar">
      <span>9:41</span>
      <div class="notch"></div>
      <div class="status-icons">
        <svg viewBox="0 0 24 24" fill="currentColor"><path d="M1 1l22 22M16.72 11.06A10.94 10.94 0 0 1 19 12.55M5 12.55a10.94 10.94 0 0 1 5.17-2.39M10.71 5.05A16 16 0 0 1 22.56 9M1.42 9a15.91 15.91 0 0 1 4.7-2.88M8.53 16.11a6 6 0 0 1 6.95 0M12 20h.01" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round"/></svg>
        <svg viewBox="0 0 24 24" fill="currentColor"><rect x="2" y="7" width="20" height="11" rx="2" ry="2"/><path d="M22 11V9" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round"/><rect x="5" y="10" width="11" height="5" rx="1" fill="var(--lime)"/></svg>
      </div>
    </div>

    <div class="app" id="app-root">

      <!-- ===== SPLASH ===== -->
      <div class="screen active" id="splash">
        <div class="splash-bg">
          <div class="splash-blob blob1"></div>
          <div class="splash-blob blob2"></div>
          <div class="splash-blob blob3"></div>
          <div class="splash-scan-line"></div>
        </div>
        <div class="splash-content">
          <div class="splash-logo">
            <svg viewBox="0 0 48 48" fill="none">
              <rect x="6" y="10" width="36" height="28" rx="6" fill="rgba(255,255,255,0.15)"/>
              <rect x="6" y="10" width="16" height="6" rx="3" fill="rgba(255,255,255,0.3)"/>
              <path d="M20 28l4-8 4 8" stroke="var(--lime)" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M21.5 25.5h5" stroke="var(--lime)" stroke-width="2.5" stroke-linecap="round"/>
              <circle cx="36" cy="34" r="8" fill="var(--lime)"/>
              <path d="M33 34l2 2 4-4" stroke="var(--sapphire)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
          <div class="splash-wordmark">fil<span>o</span></div>
          <div class="splash-tagline">Every file, in its place.</div>
        </div>
        <div class="splash-powered">Powered by On-Device ML ¬∑ 100% Private</div>
      </div>

      <!-- ===== ONBOARDING ===== -->
      <div class="screen" id="onboarding">
        <div class="onboarding-pager" id="ob-pager">
          <!-- Page 1 -->
          <div class="onboard-page">
            <div class="onboard-illustration">
              <div class="onboard-ring ring1"></div>
              <div class="onboard-ring ring2"></div>
              <div class="onboard-icon-wrap">
                <svg viewBox="0 0 80 80" fill="none">
                  <rect x="10" y="15" width="35" height="45" rx="6" fill="rgba(92,107,192,0.3)" stroke="var(--indigo)" stroke-width="1.5"/>
                  <rect x="55" y="10" width="12" height="55" rx="6" fill="rgba(198,241,53,0.2)" stroke="var(--lime)" stroke-width="1.5"/>
                  <path d="M20 30h20M20 38h15M20 46h18" stroke="var(--indigo-light)" stroke-width="2" stroke-linecap="round"/>
                  <path d="M30 45 Q45 35 55 28" stroke="var(--lime)" stroke-width="2" stroke-dasharray="4 3" marker-end="url(#arr)" stroke-linecap="round"/>
                  <circle cx="28" cy="58" r="4" fill="var(--lime)" opacity="0.8">
                    <animate attributeName="opacity" values="0.8;0.2;0.8" dur="2s" repeatCount="indefinite"/>
                  </circle>
                </svg>
              </div>
            </div>
            <div class="onboard-tag">Instant Detection</div>
            <div class="onboard-title">Files detected<br>instantly</div>
            <div class="onboard-subtitle">Filo watches your storage 24/7. The moment a file arrives, we catch it ‚Äî before you even know it's there.</div>
          </div>
          <!-- Page 2 -->
          <div class="onboard-page">
            <div class="onboard-illustration">
              <div class="onboard-ring ring1"></div>
              <div class="onboard-ring ring2"></div>
              <div class="onboard-icon-wrap">
                <svg viewBox="0 0 80 80" fill="none">
                  <rect x="12" y="8" width="56" height="64" rx="8" fill="rgba(198,241,53,0.1)" stroke="var(--lime)" stroke-width="1.5"/>
                  <rect x="20" y="20" width="40" height="6" rx="3" fill="rgba(198,241,53,0.4)">
                    <animate attributeName="opacity" values="1;0.3;1" dur="1.5s" repeatCount="indefinite"/>
                  </rect>
                  <rect x="20" y="32" width="30" height="4" rx="2" fill="rgba(92,107,192,0.5)"/>
                  <rect x="20" y="40" width="36" height="4" rx="2" fill="rgba(92,107,192,0.3)"/>
                  <rect x="20" y="48" width="24" height="4" rx="2" fill="rgba(92,107,192,0.2)"/>
                  <rect x="8" y="16" width="4" height="50" rx="2" fill="var(--lime)" opacity="0.6">
                    <animate attributeName="y" values="16;56;16" dur="2s" repeatCount="indefinite" calcMode="ease-in-out"/>
                  </rect>
                </svg>
              </div>
            </div>
            <div class="onboard-tag">Smart OCR</div>
            <div class="onboard-title">Reads what's<br>inside</div>
            <div class="onboard-subtitle">OCR technology reads bills, receipts, IDs, and contracts ‚Äî naming them properly so you never have to.</div>
          </div>
          <!-- Page 3 -->
          <div class="onboard-page">
            <div class="onboard-illustration">
              <div class="onboard-ring ring1"></div>
              <div class="onboard-ring ring2"></div>
              <div class="onboard-icon-wrap">
                <svg viewBox="0 0 80 80" fill="none">
                  <rect x="10" y="30" width="22" height="28" rx="5" fill="rgba(92,107,192,0.3)" stroke="var(--indigo)" stroke-width="1.5"/>
                  <rect x="36" y="20" width="22" height="38" rx="5" fill="rgba(198,241,53,0.15)" stroke="var(--lime)" stroke-width="1.5"/>
                  <rect x="58" y="35" width="14" height="23" rx="5" fill="rgba(255,179,0,0.2)" stroke="var(--cat-electric)" stroke-width="1.5"/>
                  <text x="15" y="48" font-size="12" fill="var(--indigo-light)">üìÑ</text>
                  <text x="40" y="44" font-size="12" fill="var(--lime)">üìã</text>
                  <text x="61" y="51" font-size="10" fill="var(--cat-electric)">‚ö°</text>
                </svg>
              </div>
            </div>
            <div class="onboard-tag">Zero Effort</div>
            <div class="onboard-title">Perfect order,<br>automatically</div>
            <div class="onboard-subtitle">Electricity bill? Bank statement? Medical report? Filo puts everything exactly where it belongs ‚Äî forever.</div>
          </div>
        </div>
        <div class="onboard-dots" id="ob-dots">
          <div class="dot active"></div>
          <div class="dot"></div>
          <div class="dot"></div>
        </div>
        <div class="onboard-footer">
          <button class="btn btn-primary" id="ob-next-btn" onclick="obNext()">Next</button>
          <button class="btn btn-ghost" onclick="obSkip()">Skip for now</button>
        </div>
      </div>

      <!-- ===== MAIN APP ===== -->
      <div id="main-app">
        <div class="main-content">

          <!-- DASHBOARD TAB -->
          <div class="tab-screen active" id="tab-home">
            <div class="dash-header">
              <div class="dash-top">
                <div>
                  <div class="greeting-sub">Good morning,</div>
                  <div class="greeting-main">Your Storage</div>
                </div>
                <div class="dash-actions">
                  <div class="scan-badge idle" id="scan-badge">
                    <div class="scan-pulse"></div>
                    <span id="scan-text">Watching</span>
                  </div>
                  <button class="settings-btn" onclick="goTo('tab-settings')">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"/><path d="M12 1v4M12 19v4M4.22 4.22l2.83 2.83M16.95 16.95l2.83 2.83M1 12h4M19 12h4M4.22 19.78l2.83-2.83M16.95 7.05l2.83-2.83"/></svg>
                  </button>
                </div>
              </div>
              <!-- Stats strip -->
              <div class="stats-strip">
                <div class="stat-card">
                  <div class="stat-icon" style="background:rgba(92,107,192,0.15)">
                    <svg viewBox="0 0 24 24" fill="none" stroke="var(--indigo-light)" stroke-width="2" stroke-linecap="round"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/></svg>
                  </div>
                  <div>
                    <div class="stat-num" id="stat-total">0</div>
                    <div class="stat-label">Total Files</div>
                  </div>
                </div>
                <div class="stat-card">
                  <div class="stat-icon" style="background:rgba(198,241,53,0.1)">
                    <svg viewBox="0 0 24 24" fill="none" stroke="var(--lime)" stroke-width="2" stroke-linecap="round"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>
                  </div>
                  <div>
                    <div class="stat-num" id="stat-today">0</div>
                    <div class="stat-label">Organized Today</div>
                  </div>
                </div>
                <div class="stat-card">
                  <div class="stat-icon" style="background:rgba(255,179,0,0.1)">
                    <svg viewBox="0 0 24 24" fill="none" stroke="var(--cat-electric)" stroke-width="2" stroke-linecap="round"><circle cx="12" cy="12" r="10"/><path d="M12 8v4l3 3"/></svg>
                  </div>
                  <div>
                    <div class="stat-num" id="stat-ocr">0</div>
                    <div class="stat-label">OCR Scanned</div>
                  </div>
                </div>
                <div class="stat-card">
                  <div class="stat-icon" style="background:rgba(105,240,174,0.1)">
                    <svg viewBox="0 0 24 24" fill="none" stroke="var(--success)" stroke-width="2" stroke-linecap="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>
                  </div>
                  <div>
                    <div class="stat-num" id="stat-size">0 MB</div>
                    <div class="stat-label">Organized</div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Activity -->
            <div class="section-header">
              <span class="section-title">Recently Organized</span>
              <span class="section-link" onclick="goTo('tab-cats')">See All ‚Üí</span>
            </div>
            <div class="activity-list" id="activity-list">
              <div class="empty-state">
                <div class="empty-icon">üóÇÔ∏è</div>
                <div class="empty-title">Watching for files‚Ä¶</div>
                <div class="empty-sub">Drop a file into Downloads and Filo will organize it automatically.</div>
              </div>
            </div>

            <!-- Categories mini -->
            <div class="section-header" style="padding-top: 24px;">
              <span class="section-title">Categories</span>
              <span class="section-link" onclick="goTo('tab-cats')">View All ‚Üí</span>
            </div>
            <div class="cat-grid" id="cat-mini-grid"></div>

            <div class="scroll-end"></div>
            <div style="height:80px"></div>
          </div>

          <!-- FAB -->
          <button class="fab" id="main-fab" onclick="triggerManualScan()">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><circle cx="11" cy="11" r="8"/><path d="M21 21l-4.35-4.35"/></svg>
            Manual Scan
          </button>

          <!-- CATEGORIES TAB -->
          <div class="tab-screen" id="tab-cats">
            <div class="cat-screen-header">
              <div class="screen-title">Categories</div>
              <div class="screen-sub" id="cat-sub">Loading categories‚Ä¶</div>
            </div>
            <div class="cat-full-grid" id="cat-full-grid"></div>
            <div class="scroll-end"></div>
          </div>

          <!-- SEARCH TAB -->
          <div class="tab-screen" id="tab-search">
            <div class="search-header">
              <div class="screen-title">Search</div>
              <div class="search-input-wrap">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><circle cx="11" cy="11" r="8"/><path d="M21 21l-4.35-4.35"/></svg>
                <input class="search-input" placeholder="Search files, content, tags‚Ä¶" id="search-input" oninput="doSearch(this.value)">
              </div>
            </div>
            <div class="filter-chips" id="search-chips">
              <div class="chip active" onclick="setSearchFilter('all',this)">All</div>
              <div class="chip" onclick="setSearchFilter('bills',this)">‚ö° Bills</div>
              <div class="chip" onclick="setSearchFilter('finance',this)">üí∞ Finance</div>
              <div class="chip" onclick="setSearchFilter('medical',this)">üè• Medical</div>
              <div class="chip" onclick="setSearchFilter('identity',this)">ü™™ Identity</div>
              <div class="chip" onclick="setSearchFilter('images',this)">üñºÔ∏è Images</div>
            </div>
            <div class="activity-list" id="search-results" style="padding-bottom:80px">
              <div class="empty-state">
                <div class="empty-icon">üîç</div>
                <div class="empty-title">Start searching</div>
                <div class="empty-sub">Search across file names and OCR-extracted content.</div>
              </div>
            </div>
          </div>

          <!-- STATS TAB -->
          <div class="tab-screen" id="tab-stats">
            <div class="stats-header">
              <div class="screen-title">Statistics</div>
              <div class="screen-sub" style="font-size:14px;color:var(--on-surface-3);margin-top:4px">Your file organization overview</div>
            </div>
            <div class="donut-wrap">
              <div class="donut-chart">
                <svg viewBox="0 0 200 200" id="donut-svg"></svg>
                <div class="donut-center">
                  <div class="donut-center-num" id="donut-total">0</div>
                  <div class="donut-center-label">Total Files</div>
                </div>
              </div>
              <div class="donut-legend" id="donut-legend"></div>
            </div>
            <div class="section-header">
              <span class="section-title">Files by Category</span>
            </div>
            <div class="bar-chart" id="bar-chart"></div>
            <div class="scroll-end"></div>
          </div>

          <!-- SETTINGS TAB -->
          <div class="tab-screen" id="tab-settings">
            <div class="stats-header">
              <div class="screen-title">Settings</div>
            </div>
            <div class="settings-body">
              <div class="settings-section-title">General</div>
              <div class="settings-item">
                <div class="settings-item-icon" style="background:rgba(92,107,192,0.15)">
                  <svg viewBox="0 0 24 24" fill="none" stroke="var(--indigo-light)" stroke-width="2" stroke-linecap="round"><path d="M9 3H5a2 2 0 0 0-2 2v4m6-6h10a2 2 0 0 1 2 2v4M9 3v18m0 0h10a2 2 0 0 0 2-2V9M9 21H5a2 2 0 0 1-2-2V9m0 0h18"/></svg>
                </div>
                <div class="settings-item-info">
                  <div class="settings-item-name">Auto-Organize Files</div>
                  <div class="settings-item-desc">Organize new files automatically</div>
                </div>
                <div class="settings-item-right">
                  <button class="toggle on" onclick="toggleSwitch(this)"><div class="toggle-thumb"></div></button>
                </div>
              </div>
              <div class="settings-item">
                <div class="settings-item-icon" style="background:rgba(198,241,53,0.1)">
                  <svg viewBox="0 0 24 24" fill="none" stroke="var(--lime)" stroke-width="2" stroke-linecap="round"><rect x="5" y="2" width="14" height="20" rx="2"/><line x1="9" y1="7" x2="15" y2="7"/><line x1="9" y1="11" x2="15" y2="11"/><line x1="9" y1="15" x2="13" y2="15"/></svg>
                </div>
                <div class="settings-item-info">
                  <div class="settings-item-name">Run OCR on Documents</div>
                  <div class="settings-item-desc">Read text to identify file type</div>
                </div>
                <div class="settings-item-right">
                  <button class="toggle on" onclick="toggleSwitch(this)"><div class="toggle-thumb"></div></button>
                </div>
              </div>
              <div class="settings-item">
                <div class="settings-item-icon" style="background:rgba(233,30,99,0.1)">
                  <svg viewBox="0 0 24 24" fill="none" stroke="var(--cat-image)" stroke-width="2" stroke-linecap="round"><rect x="3" y="3" width="18" height="18" rx="2"/><circle cx="8.5" cy="8.5" r="1.5"/><polyline points="21 15 16 10 5 21"/></svg>
                </div>
                <div class="settings-item-info">
                  <div class="settings-item-name">Organize Images</div>
                  <div class="settings-item-desc">Sort images into folders</div>
                </div>
                <div class="settings-item-right">
                  <button class="toggle" onclick="toggleSwitch(this)"><div class="toggle-thumb"></div></button>
                </div>
              </div>
              <div class="settings-item">
                <div class="settings-item-icon" style="background:rgba(244,81,30,0.1)">
                  <svg viewBox="0 0 24 24" fill="none" stroke="var(--cat-video)" stroke-width="2" stroke-linecap="round"><polygon points="23 7 16 12 23 17 23 7"/><rect x="1" y="5" width="15" height="14" rx="2"/></svg>
                </div>
                <div class="settings-item-info">
                  <div class="settings-item-name">Organize Videos</div>
                  <div class="settings-item-desc">Sort videos into Media folder</div>
                </div>
                <div class="settings-item-right">
                  <button class="toggle" onclick="toggleSwitch(this)"><div class="toggle-thumb"></div></button>
                </div>
              </div>

              <div class="settings-section-title">Storage</div>
              <div class="settings-item">
                <div class="settings-item-icon" style="background:rgba(105,240,174,0.1)">
                  <svg viewBox="0 0 24 24" fill="none" stroke="var(--success)" stroke-width="2" stroke-linecap="round"><path d="M22 12H2"/><path d="M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z"/></svg>
                </div>
                <div class="settings-item-info">
                  <div class="settings-item-name">Organize to Folder</div>
                  <div class="settings-item-desc">/Filo/Organized</div>
                </div>
                <div class="settings-item-right">
                  <svg viewBox="0 0 24 24" fill="none" stroke="var(--on-surface-3)" stroke-width="2" width="16" stroke-linecap="round"><polyline points="9 18 15 12 9 6"/></svg>
                </div>
              </div>
              <div class="settings-item">
                <div class="settings-item-icon" style="background:rgba(64,196,255,0.1)">
                  <svg viewBox="0 0 24 24" fill="none" stroke="var(--info)" stroke-width="2" stroke-linecap="round"><path d="M1 6v16l7-4 8 4 7-4V2l-7 4-8-4-7 4z"/><path d="M8 2v16M16 6v16"/></svg>
                </div>
                <div class="settings-item-info">
                  <div class="settings-item-name">Keep Original Copy</div>
                  <div class="settings-item-desc">Don't delete originals</div>
                </div>
                <div class="settings-item-right">
                  <button class="toggle" onclick="toggleSwitch(this)"><div class="toggle-thumb"></div></button>
                </div>
              </div>

              <div class="settings-section-title">Notifications</div>
              <div class="settings-item">
                <div class="settings-item-icon" style="background:rgba(255,215,64,0.1)">
                  <svg viewBox="0 0 24 24" fill="none" stroke="var(--warning)" stroke-width="2" stroke-linecap="round"><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"/><path d="M13.73 21a2 2 0 0 1-3.46 0"/></svg>
                </div>
                <div class="settings-item-info">
                  <div class="settings-item-name">File Organized Alert</div>
                  <div class="settings-item-desc">Notify when file is organized</div>
                </div>
                <div class="settings-item-right">
                  <button class="toggle on" onclick="toggleSwitch(this)"><div class="toggle-thumb"></div></button>
                </div>
              </div>
              <div class="settings-item">
                <div class="settings-item-icon" style="background:rgba(92,107,192,0.15)">
                  <svg viewBox="0 0 24 24" fill="none" stroke="var(--indigo-light)" stroke-width="2" stroke-linecap="round"><rect x="3" y="4" width="18" height="18" rx="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
                </div>
                <div class="settings-item-info">
                  <div class="settings-item-name">Daily Summary</div>
                  <div class="settings-item-desc">Daily digest at 8:00 PM</div>
                </div>
                <div class="settings-item-right">
                  <button class="toggle on" onclick="toggleSwitch(this)"><div class="toggle-thumb"></div></button>
                </div>
              </div>

              <div class="settings-section-title">Privacy</div>
              <div class="settings-item">
                <div class="settings-item-icon" style="background:rgba(105,240,174,0.1)">
                  <svg viewBox="0 0 24 24" fill="none" stroke="var(--success)" stroke-width="2" stroke-linecap="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
                </div>
                <div class="settings-item-info">
                  <div class="settings-item-name">On-Device Only</div>
                  <div class="settings-item-desc">100% private ¬∑ No cloud uploads</div>
                </div>
                <div class="settings-item-right">
                  <span class="tag" style="background:rgba(105,240,174,0.15);color:var(--success)">Locked</span>
                </div>
              </div>
              <div class="settings-item" onclick="showToast('üóëÔ∏è','OCR Cache Cleared','All cached OCR data removed.')">
                <div class="settings-item-icon" style="background:rgba(255,82,82,0.1)">
                  <svg viewBox="0 0 24 24" fill="none" stroke="var(--error)" stroke-width="2" stroke-linecap="round"><polyline points="3 6 5 6 21 6"/><path d="M19 6l-1 14a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2L5 6"/><path d="M10 11v6M14 11v6"/></svg>
                </div>
                <div class="settings-item-info">
                  <div class="settings-item-name">Clear OCR Cache</div>
                  <div class="settings-item-desc">Free up storage space</div>
                </div>
                <div class="settings-item-right">
                  <svg viewBox="0 0 24 24" fill="none" stroke="var(--on-surface-3)" stroke-width="2" width="16" stroke-linecap="round"><polyline points="9 18 15 12 9 6"/></svg>
                </div>
              </div>

              <div class="settings-section-title">About</div>
              <div class="settings-item">
                <div class="settings-item-icon" style="background:rgba(92,107,192,0.15)">
                  <svg viewBox="0 0 24 24" fill="none" stroke="var(--indigo-light)" stroke-width="2" stroke-linecap="round"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>
                </div>
                <div class="settings-item-info">
                  <div class="settings-item-name">Version</div>
                  <div class="settings-item-desc">Filo v1.0.0 ¬∑ Build 100</div>
                </div>
                <div class="settings-item-right">
                  <span class="tag" style="background:rgba(198,241,53,0.1);color:var(--lime)">Latest</span>
                </div>
              </div>
            </div>
          </div>

          <!-- FILE LIST DETAIL SCREEN -->
          <div class="detail-screen" id="file-list-screen">
            <div class="detail-header">
              <button class="back-btn" onclick="closeFileList()">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><polyline points="15 18 9 12 15 6"/></svg>
              </button>
              <div>
                <div class="detail-header-title" id="file-list-title">Category</div>
                <div class="detail-header-sub" id="file-list-sub">0 files</div>
              </div>
            </div>
            <div class="file-list-body" id="file-list-body"></div>
          </div>

          <!-- FILE DETAIL POPUP -->
          <div id="file-detail-popup">
            <div class="detail-header">
              <button class="back-btn" onclick="closeFileDetail()">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><polyline points="15 18 9 12 15 6"/></svg>
              </button>
              <div>
                <div class="detail-header-title">File Details</div>
              </div>
            </div>
            <div class="file-preview-hero" id="fd-hero"></div>
            <div class="file-detail-body">
              <div class="detail-info-card">
                <div class="detail-info-label">Smart Name</div>
                <div class="detail-info-value" id="fd-smart-name" style="font-size:16px;margin-bottom:10px"></div>
                <div class="detail-info-label">Original Name</div>
                <div class="detail-info-value" id="fd-orig-name" style="font-size:13px;color:var(--on-surface-2)"></div>
              </div>
              <div class="detail-info-card">
                <div class="detail-info-label">Moved To</div>
                <div class="path-arrow">
                  <div>
                    <div class="path-old" id="fd-old-path"></div>
                    <div style="color:var(--on-surface-3);font-size:16px;text-align:center;margin:4px 0">‚Üì</div>
                    <div class="path-new" id="fd-new-path"></div>
                  </div>
                </div>
              </div>
              <div class="detail-info-card">
                <div style="display:flex;gap:16px">
                  <div style="flex:1">
                    <div class="detail-info-label">Category</div>
                    <div class="detail-info-value" id="fd-category" style="font-size:14px"></div>
                  </div>
                  <div style="flex:1">
                    <div class="detail-info-label">File Size</div>
                    <div class="detail-info-value" id="fd-size" style="font-size:14px"></div>
                  </div>
                  <div style="flex:1">
                    <div class="detail-info-label">OCR Score</div>
                    <div class="detail-info-value" id="fd-ocr" style="font-size:14px"></div>
                  </div>
                </div>
              </div>
              <div class="detail-info-card" id="fd-ocr-section">
                <div class="detail-info-label" style="margin-bottom:10px">OCR Extracted Text</div>
                <div class="ocr-text-block" id="fd-ocr-text"></div>
              </div>
              <div class="detail-info-card">
                <div class="detail-info-label" style="margin-bottom:8px">Auto Tags</div>
                <div id="fd-tags" style="display:flex;flex-wrap:wrap;gap:6px"></div>
              </div>
              <div class="action-row">
                <button class="action-btn" style="background:rgba(92,107,192,0.15);color:var(--indigo-light)">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" width="16"><path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"/><polyline points="16 6 12 2 8 6"/><line x1="12" y1="2" x2="12" y2="15"/></svg>
                  Share
                </button>
                <button class="action-btn" style="background:rgba(198,241,53,0.1);color:var(--lime)">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" width="16"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>
                  Open
                </button>
                <button class="action-btn" style="background:rgba(255,82,82,0.1);color:var(--error)" onclick="closeFileDetail()">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" width="16"><polyline points="3 6 5 6 21 6"/><path d="M19 6l-1 14H6L5 6"/></svg>
                  Delete
                </button>
              </div>
            </div>
          </div>

          <!-- SCANNING OVERLAY -->
          <div class="scanning-overlay" id="scan-overlay">
            <div class="scan-ring">
              <div class="scan-ring-inner" id="scan-emoji">üìÑ</div>
            </div>
            <div class="scan-title" id="scan-overlay-title">Scanning file‚Ä¶</div>
            <div class="scan-sub" id="scan-overlay-sub">Running OCR to detect content type</div>
            <div class="scan-progress-wrap">
              <div class="scan-step" id="scan-step-text">Initializing‚Ä¶</div>
              <div class="scan-progress-bar">
                <div class="scan-progress-fill" id="scan-progress"></div>
              </div>
            </div>
          </div>

        </div>

        <!-- BOTTOM NAV -->
        <nav class="bottom-nav">
          <div class="nav-item active" onclick="switchTab('home',this)" id="nav-home">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
            <span>Home</span>
            <div class="nav-indicator"></div>
          </div>
          <div class="nav-item" onclick="switchTab('cats',this)" id="nav-cats">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/></svg>
            <span>Categories</span>
            <div class="nav-indicator"></div>
            <div class="nav-badge" id="nav-cats-badge" style="display:none">0</div>
          </div>
          <div class="nav-item" onclick="switchTab('search',this)" id="nav-search">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><circle cx="11" cy="11" r="8"/><path d="M21 21l-4.35-4.35"/></svg>
            <span>Search</span>
            <div class="nav-indicator"></div>
          </div>
          <div class="nav-item" onclick="switchTab('stats',this)" id="nav-stats">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><line x1="18" y1="20" x2="18" y2="10"/><line x1="12" y1="20" x2="12" y2="4"/><line x1="6" y1="20" x2="6" y2="14"/></svg>
            <span>Stats</span>
            <div class="nav-indicator"></div>
          </div>
          <div class="nav-item" onclick="switchTab('settings',this)" id="nav-settings">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><circle cx="12" cy="12" r="3"/><path d="M12 1v4M12 19v4M4.22 4.22l2.83 2.83M16.95 16.95l2.83 2.83M1 12h4M19 12h4M4.22 19.78l2.83-2.83M16.95 7.05l2.83-2.83"/></svg>
            <span>Settings</span>
            <div class="nav-indicator"></div>
          </div>
        </nav>
      </div>

      <!-- TOAST -->
      <div class="toast" id="toast">
        <div class="toast-icon" id="toast-icon"></div>
        <div class="toast-text">
          <div class="toast-title" id="toast-title"></div>
          <div class="toast-sub" id="toast-sub"></div>
        </div>
        <div class="toast-undo" id="toast-undo" onclick="undoLast()">Undo</div>
      </div>
    </div>
  </div>
</div>

<script>
// ===== DATA LAYER =====
const FILES_DB = [];
let statsTotal = 0, statsToday = 0, statsOCR = 0, statsSizeMB = 0;
let lastOrganized = null;
let obPage = 0;
let searchFilter = 'all';

const CATEGORIES = [
  { id:'electricity', name:'Electricity Bills', icon:'‚ö°', color:'#FFB300', path:'Bills/Electricity', keywords:['electricity','kwh','meter reading','power bill','kseb','units consumed'] },
  { id:'water', name:'Water Bills', icon:'üíß', color:'#0288D1', path:'Bills/Water', keywords:['water bill','gallons','cubic meter','water board','water supply'] },
  { id:'bank', name:'Bank Statements', icon:'üè¶', color:'#2E7D32', path:'Finance/BankStatements', keywords:['account statement','transaction','balance','debit','credit','ifsc','account number','hdfc','sbi','icici'] },
  { id:'salary', name:'Salary Slips', icon:'üíº', color:'#283593', path:'Finance/Salary', keywords:['salary slip','payslip','basic salary','net pay','employee id','pf','esi','gross'] },
  { id:'invoice', name:'Invoices', icon:'üßæ', color:'#6A1B9A', path:'Finance/Invoices', keywords:['invoice','invoice no','tax invoice','gst','amount due','payable','billed to'] },
  { id:'receipt', name:'Receipts', icon:'üßæ', color:'#00695C', path:'Finance/Receipts', keywords:['receipt','payment received','thank you for purchase','subtotal','total paid','paid'] },
  { id:'tax', name:'Tax Documents', icon:'üìä', color:'#C62828', path:'Finance/Tax', keywords:['itr','income tax','form 16','tds','pan number','assessment year','refund'] },
  { id:'medical', name:'Medical Reports', icon:'üè•', color:'#D32F2F', path:'Medical/Reports', keywords:['blood test','lab report','patient','diagnosis','prescription','hospital','doctor'] },
  { id:'prescription', name:'Prescriptions', icon:'üíä', color:'#AD1457', path:'Medical/Prescriptions', keywords:['rx','prescribed','dosage','tablets','syrup','capsules','medicine'] },
  { id:'insurance', name:'Insurance', icon:'üõ°Ô∏è', color:'#37474F', path:'Legal/Insurance', keywords:['insurance','policy number','premium','coverage','insured','beneficiary'] },
  { id:'identity', name:'Identity Docs', icon:'ü™™', color:'#4527A0', path:'Identity', keywords:['aadhaar','pan card','passport','driving licence','voter id','date of birth','nationality'] },
  { id:'academic', name:'Academic', icon:'üéì', color:'#00838F', path:'Academic', keywords:['marksheet','certificate','grade','university','school','admit card','result','gpa'] },
  { id:'legal', name:'Legal Docs', icon:'‚öñÔ∏è', color:'#827717', path:'Legal/General', keywords:['agreement','contract','deed','affidavit','notary','legal notice','court'] },
  { id:'image', name:'Images', icon:'üñºÔ∏è', color:'#E91E63', path:'Media/Images', keywords:[] },
  { id:'video', name:'Videos', icon:'üé¨', color:'#F4511E', path:'Media/Videos', keywords:[] },
  { id:'audio', name:'Audio Files', icon:'üéµ', color:'#00897B', path:'Media/Audio', keywords:[] },
  { id:'apk', name:'APK Files', icon:'üì¶', color:'#546E7A', path:'Apps/APKs', keywords:[] },
  { id:'other', name:'Others', icon:'üìÅ', color:'#455A64', path:'Others', keywords:[] },
];

const SAMPLE_FILES = [
  { name:'IMG_20240112_083422.pdf', emoji:'üìÑ', ocrText:'KSEB ELECTRICITY BILL\nConsumer No: 1234567\nBill Month: December 2024\nUnits Consumed: 320 kWh\nAmount Payable: ‚Çπ1,240\nDue Date: 15 Jan 2025\nMeter Reading: 8542', cat:'electricity', size:0.8, tags:['KSEB','December 2024','‚Çπ1,240'] },
  { name:'scan001.pdf', emoji:'üìÑ', ocrText:'HDFC BANK\nAccount Statement\nAccount Number: XXXX8821\nStatement Period: Dec 2024\nOpening Balance: ‚Çπ45,200\nClosing Balance: ‚Çπ38,750\nTotal Transactions: 24', cat:'bank', size:1.2, tags:['HDFC Bank','December 2024'] },
  { name:'doc_2024_receipt.jpg', emoji:'üñºÔ∏è', ocrText:'AMAZON INDIA\nPayment Receipt\nOrder #402-1234567\nDate: 12 Jan 2025\nSubtotal: ‚Çπ2,499\nShipping: FREE\nTotal Paid: ‚Çπ2,499\nPayment: UPI', cat:'receipt', size:0.4, tags:['Amazon','‚Çπ2,499','January 2025'] },
  { name:'salary_dec.pdf', emoji:'üìÑ', ocrText:'SALARY SLIP\nEmployee Name: Rahul Sharma\nEmployee ID: EMP00234\nDesignation: Software Engineer\nMonth: December 2024\nBasic Salary: ‚Çπ65,000\nHRA: ‚Çπ26,000\nPF Deduction: ‚Çπ7,800\nNet Pay: ‚Çπ78,200', cat:'salary', size:0.6, tags:['December 2024','‚Çπ78,200','PF'] },
  { name:'report_blood.pdf', emoji:'üìÑ', ocrText:'PATHOLOGY LAB REPORT\nPatient Name: Priya Mehta\nDate: 10 Jan 2025\nTest: Complete Blood Count\nHemoglobin: 13.2 g/dL (Normal)\nWBC: 7,200 /ŒºL (Normal)\nPlatelet: 2.8 Lakh (Normal)\nConclusion: Normal', cat:'medical', size:0.5, tags:['Blood Test','Normal','Jan 2025'] },
  { name:'20250110_134521.jpg', emoji:'üñºÔ∏è', ocrText:'', cat:'image', size:2.1, tags:['Photo','JPEG'] },
  { name:'gst_invoice_vendor.pdf', emoji:'üìÑ', ocrText:'TAX INVOICE\nInvoice No: INV-2025-0089\nDate: 08 Jan 2025\nGST No: 27AAACP1234A1Z1\nBilled To: Tech Solutions Ltd\nItems: Cloud Hosting Services\nSubtotal: ‚Çπ15,000\nGST 18%: ‚Çπ2,700\nTotal: ‚Çπ17,700', cat:'invoice', size:0.7, tags:['GST','‚Çπ17,700','Jan 2025'] },
  { name:'aadhar_scan.pdf', emoji:'üìÑ', ocrText:'GOVERNMENT OF INDIA\nAadhaar Card\nName: Vijay Kumar\nDate of Birth: 15/08/1990\nGender: Male\nUID: XXXX XXXX 7821\nAddress: Bengaluru, Karnataka\n560001', cat:'identity', size:0.3, tags:['Aadhaar','Identity'] },
  { name:'water_bill_q3.pdf', emoji:'üìÑ', ocrText:'BANGALORE WATER SUPPLY\nConsumer Bill\nConsumer ID: BWS9923\nBilling Period: Oct-Dec 2024\nWater Consumed: 18 Kilolitres\nAmount: ‚Çπ680\nDue Date: 20 Jan 2025', cat:'water', size:0.4, tags:['Water Bill','‚Çπ680','BWSSB'] },
  { name:'policy_doc.pdf', emoji:'üìÑ', ocrText:'LIFE INSURANCE POLICY\nPolicy No: LIC-8877441\nPolicyholder: Anita Desai\nSum Assured: ‚Çπ25,00,000\nPremium: ‚Çπ12,500/year\nCoverage: Term Life\nExpiry: 2044', cat:'insurance', size:1.1, tags:['LIC','Life Insurance','‚Çπ25L'] },
  { name:'form16_2024.pdf', emoji:'üìÑ', ocrText:'FORM 16\nCertificate of TDS on Salary\nAssessment Year: 2024-25\nPAN: ABCDE1234F\nEmployee: Sanjay Patel\nTotal Salary: ‚Çπ9,60,000\nTax Deducted: ‚Çπ82,500\nNet Salary: ‚Çπ8,77,500', cat:'tax', size:0.9, tags:['Form 16','TDS','AY 2024-25'] },
  { name:'marksheet_sem6.pdf', emoji:'üìÑ', ocrText:'UNIVERSITY OF MUMBAI\nSemester VI Mark Sheet\nRoll No: 2019BCE0123\nStudent: Neha Gupta\nTotal Marks: 456/600\nPercentage: 76%\nResult: FIRST CLASS\nYear: 2024', cat:'academic', size:0.5, tags:['University','Marksheet','76%'] },
];

function generateSmartName(file, cat) {
  const now = new Date();
  const months = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
  const mon = months[now.getMonth()];
  const yr = now.getFullYear();

  const nameMap = {
    electricity: `Electricity_Bill_${mon}_${yr}`,
    water: `Water_Bill_${mon}_${yr}`,
    bank: `Bank_Statement_${mon}_${yr}`,
    salary: `Salary_Slip_${mon}_${yr}`,
    invoice: `GST_Invoice_${mon}_${yr}`,
    receipt: `Purchase_Receipt_${mon}_${yr}`,
    tax: `Tax_Document_${mon}_${yr}`,
    medical: `Medical_Report_${mon}_${yr}`,
    prescription: `Prescription_${mon}_${yr}`,
    insurance: `Insurance_Policy_${yr}`,
    identity: `Identity_Document_Secure`,
    academic: `Academic_Certificate_${yr}`,
    legal: `Legal_Document_${mon}_${yr}`,
    image: `Photo_${now.toISOString().slice(0,10).replace(/-/g,'')}`,
    video: `Video_${now.toISOString().slice(0,10).replace(/-/g,'')}`,
    audio: `Audio_${now.toISOString().slice(0,10).replace(/-/g,'')}`,
    apk: `App_Package`,
    other: `File_${mon}_${yr}`,
  };
  const base = nameMap[cat.id] || 'Organized_File';
  const ext = file.name.split('.').pop();
  return `${base}.${ext}`;
}

function getCat(id) { return CATEGORIES.find(c => c.id === id) || CATEGORIES[CATEGORIES.length-1]; }

// ===== NAVIGATION =====
let currentObPage = 0;

function switchTab(tab, el) {
  document.querySelectorAll('.tab-screen').forEach(s => s.classList.remove('active'));
  document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
  document.getElementById('tab-' + tab).classList.add('active');
  if(el) el.classList.add('active');
  else document.getElementById('nav-'+tab).classList.add('active');

  if(tab === 'stats') renderStats();
  if(tab === 'cats') renderCatGrid();
  if(tab === 'search') document.getElementById('search-input').focus();
}

function goTo(tabId) {
  const tab = tabId.replace('tab-','');
  const nav = document.getElementById('nav-' + tab);
  switchTab(tab, nav);
}

// ===== SPLASH ‚Üí ONBOARDING =====
setTimeout(() => {
  const splash = document.getElementById('splash');
  const ob = document.getElementById('onboarding');
  splash.classList.remove('active');
  ob.classList.add('active');
}, 2400);

// ===== ONBOARDING =====
function obNext() {
  currentObPage++;
  if(currentObPage >= 3) {
    startApp();
    return;
  }
  updateObPage();
}

function obSkip() { startApp(); }

function updateObPage() {
  const pager = document.getElementById('ob-pager');
  pager.style.transform = `translateX(-${currentObPage * 100}%)`;
  pager.style.transition = 'transform 0.4s cubic-bezier(0.4,0,0.2,1)';
  document.querySelectorAll('.dot').forEach((d,i) => {
    d.className = 'dot' + (i === currentObPage ? ' active' : '');
  });
  const btn = document.getElementById('ob-next-btn');
  btn.textContent = currentObPage === 2 ? 'Get Started ‚Äî It\'s Free' : 'Next';
}

function startApp() {
  document.getElementById('onboarding').classList.remove('active');
  document.getElementById('main-app').classList.add('active');
  setTimeout(() => beginSimulation(), 800);
}

// ===== SIMULATION ENGINE =====
let simIndex = 0;
let simQueue = [...SAMPLE_FILES].sort(() => Math.random()-0.5);

function beginSimulation() {
  renderCatMini();
  animateStats();
  scheduleNextFile();
}

function scheduleNextFile() {
  const delay = simIndex === 0 ? 1200 : 2500 + Math.random() * 3000;
  setTimeout(() => {
    if(simIndex < simQueue.length) {
      processNewFile(simQueue[simIndex++]);
    }
    if(simIndex < simQueue.length) scheduleNextFile();
  }, delay);
}

function processNewFile(fileData) {
  setScanBadge(true);
  showScanOverlay(fileData);

  const cat = getCat(fileData.cat);
  const smartName = generateSmartName(fileData, cat);
  const ocrScore = fileData.ocrText.length > 0 ? Math.floor(82 + Math.random()*16) : 0;

  const record = {
    id: Date.now() + Math.random(),
    ...fileData,
    smartName,
    cat: cat,
    ocrScore,
    originalPath: `/storage/Downloads/${fileData.name}`,
    newPath: `/storage/Filo/${cat.path}/${smartName}`,
    time: new Date(),
    sizeFormatted: fileData.size < 1 ? `${Math.round(fileData.size*1024)} KB` : `${fileData.size.toFixed(1)} MB`,
  };

  FILES_DB.unshift(record);
  lastOrganized = record;

  setTimeout(() => {
    hideScanOverlay();
    setScanBadge(false);
    addFileToActivity(record);
    updateStats(record);
    renderCatMini();
    showToast(cat.icon, `Organized: ${smartName}`, `Moved to ${cat.path}`);
  }, 3200);
}

// ===== SCAN OVERLAY =====
function showScanOverlay(fileData) {
  const ov = document.getElementById('scan-overlay');
  const cat = getCat(fileData.cat);
  document.getElementById('scan-emoji').textContent = fileData.emoji;
  document.getElementById('scan-overlay-title').textContent = `Scanning: ${fileData.name.slice(0,24)}‚Ä¶`;
  ov.classList.add('active');

  const steps = [
    [0,'Detecting file type‚Ä¶'],
    [20,'Reading file header‚Ä¶'],
    [40,'Running OCR engine‚Ä¶'],
    [60,'Extracting keywords‚Ä¶'],
    [80,'Matching category‚Ä¶'],
    [95,'Organizing file‚Ä¶'],
  ];

  steps.forEach(([pct, text], i) => {
    setTimeout(() => {
      document.getElementById('scan-progress').style.width = pct + '%';
      document.getElementById('scan-step-text').textContent = text;
      if(i === 2) document.getElementById('scan-overlay-sub').textContent = 'Reading text content with ML Kit OCR';
      if(i === 4) document.getElementById('scan-overlay-sub').textContent = `Detected: ${cat.name}`;
    }, i * 500);
  });
}

function hideScanOverlay() {
  document.getElementById('scan-progress').style.width = '100%';
  document.getElementById('scan-step-text').textContent = 'Done! ‚úì';
  setTimeout(() => {
    document.getElementById('scan-overlay').classList.remove('active');
    document.getElementById('scan-progress').style.width = '0';
  }, 400);
}

function setScanBadge(active) {
  const badge = document.getElementById('scan-badge');
  const text = document.getElementById('scan-text');
  if(active) {
    badge.className = 'scan-badge';
    text.textContent = 'Scanning';
  } else {
    badge.className = 'scan-badge idle';
    text.textContent = 'Watching';
  }
}

// ===== ACTIVITY LIST =====
function addFileToActivity(record) {
  const list = document.getElementById('activity-list');
  // Remove empty state
  const empty = list.querySelector('.empty-state');
  if(empty) empty.remove();

  const card = document.createElement('div');
  card.className = 'file-card';
  card.style.setProperty('--cat-color', record.cat.color);
  card.style.animationDelay = '0s';
  card.style.cursor = 'pointer';
  card.onclick = () => openFileDetail(record);
  card.innerHTML = `
    <div style="position:absolute;left:0;top:0;bottom:0;width:3px;background:${record.cat.color};border-radius:3px 0 0 3px"></div>
    <div class="file-icon-wrap" style="background:${record.cat.color}22;font-size:20px">${record.cat.icon}</div>
    <div class="file-info">
      <div class="file-name">${record.smartName}</div>
      <div class="file-original">${record.name}</div>
      <div class="file-meta">
        <span class="file-badge" style="background:${record.cat.color}22;color:${record.cat.color}">${record.cat.name}</span>
        ${record.ocrScore > 0 ? `<span class="file-badge" style="background:rgba(198,241,53,0.1);color:var(--lime)">OCR ${record.ocrScore}%</span>` : ''}
      </div>
      ${record.ocrScore > 0 ? `<div class="ocr-bar"><div class="ocr-fill" style="width:${record.ocrScore}%;background:${record.cat.color}"></div></div>` : ''}
    </div>
    <div class="file-time">${timeAgo(record.time)}</div>
  `;

  list.insertBefore(card, list.firstChild);

  // Limit to 20 in view
  const cards = list.querySelectorAll('.file-card');
  if(cards.length > 12) cards[cards.length-1].remove();
}

// ===== STATS =====
function updateStats(record) {
  statsTotal++;
  statsToday++;
  if(record.ocrScore > 0) statsOCR++;
  statsSizeMB += record.size;

  animateNum('stat-total', statsTotal);
  animateNum('stat-today', statsToday);
  animateNum('stat-ocr', statsOCR);
  document.getElementById('stat-size').textContent = statsSizeMB.toFixed(1) + ' MB';

  const badge = document.getElementById('nav-cats-badge');
  badge.style.display = 'flex';
  badge.textContent = statsToday;
}

function animateNum(id, to) {
  const el = document.getElementById(id);
  let current = parseInt(el.textContent) || 0;
  const step = () => {
    if(current < to) {
      current++;
      el.textContent = current;
      requestAnimationFrame(step);
    }
  };
  step();
}

function animateStats() {
  // Initial pulse
  ['stat-total','stat-today','stat-ocr'].forEach(id => {
    document.getElementById(id).textContent = '0';
  });
}

// ===== CATEGORY GRID =====
function renderCatMini() {
  const grid = document.getElementById('cat-mini-grid');
  const counts = getCatCounts();
  const top = CATEGORIES.filter(c => (counts[c.id]||0) > 0).slice(0,6);

  grid.innerHTML = top.length === 0 ? '' : top.map(cat => `
    <div class="cat-mini" style="--accent-color:${cat.color}" onclick="openCatList('${cat.id}')">
      <span class="cat-mini-icon">${cat.icon}</span>
      <div class="cat-mini-name">${cat.name}</div>
      <div class="cat-mini-count">${counts[cat.id]||0} files</div>
    </div>
  `).join('');
}

function renderCatGrid() {
  const grid = document.getElementById('cat-full-grid');
  const counts = getCatCounts();
  const sizes = getCatSizes();
  document.getElementById('cat-sub').textContent = `${CATEGORIES.filter(c=>(counts[c.id]||0)>0).length} active categories`;

  grid.innerHTML = CATEGORIES.map((cat, i) => {
    const count = counts[cat.id] || 0;
    const size = sizes[cat.id] || 0;
    return `
      <div class="cat-full-card" style="animation-delay:${i*0.04}s" onclick="openCatList('${cat.id}')">
        <div class="cat-card-bg" style="background:${cat.color}"></div>
        <div class="cat-card-size">${size > 0 ? size.toFixed(1)+' MB' : '‚Äî'}</div>
        <div class="cat-card-icon-wrap" style="background:${cat.color}22">${cat.icon}</div>
        <div class="cat-card-name">${cat.name}</div>
        <div class="cat-card-count">
          <svg viewBox="0 0 24 24" width="12" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/></svg>
          ${count} file${count!==1?'s':''}
        </div>
      </div>
    `;
  }).join('');
}

function getCatCounts() {
  const counts = {};
  FILES_DB.forEach(f => { counts[f.cat.id] = (counts[f.cat.id]||0) + 1; });
  return counts;
}
function getCatSizes() {
  const sizes = {};
  FILES_DB.forEach(f => { sizes[f.cat.id] = (sizes[f.cat.id]||0) + f.size; });
  return sizes;
}

// ===== FILE LIST =====
function openCatList(catId) {
  const cat = getCat(catId);
  const files = FILES_DB.filter(f => f.cat.id === catId);

  document.getElementById('file-list-title').innerHTML = `${cat.icon} ${cat.name}`;
  document.getElementById('file-list-sub').textContent = `${files.length} file${files.length!==1?'s':''}`;

  const body = document.getElementById('file-list-body');
  if(files.length === 0) {
    body.innerHTML = `<div class="empty-state"><div class="empty-icon">${cat.icon}</div><div class="empty-title">No files yet</div><div class="empty-sub">Files will appear here once Filo detects and organizes them.</div></div>`;
  } else {
    body.innerHTML = files.map((f, i) => `
      <div class="file-list-item" style="animation-delay:${i*0.06}s" onclick='openFileDetail(${JSON.stringify({id:f.id}).replace(/"/g,"'")})'>
        <div class="file-icon-wrap" style="background:${cat.color}22;font-size:20px;width:44px;height:44px;border-radius:12px;display:flex;align-items:center;justify-content:center">${f.emoji}</div>
        <div class="file-info">
          <div class="file-name">${f.smartName}</div>
          <div class="file-original">${f.name}</div>
          <div class="file-meta">
            <span class="file-badge" style="background:${cat.color}22;color:${cat.color}">${f.sizeFormatted}</span>
            ${f.ocrScore > 0 ? `<span class="file-badge" style="background:rgba(198,241,53,0.1);color:var(--lime)">OCR ‚úì</span>` : ''}
          </div>
        </div>
        <div class="file-time">${timeAgo(f.time)}</div>
      </div>
    `).join('');
  }

  document.getElementById('file-list-screen').classList.add('active');
}

function closeFileList() {
  document.getElementById('file-list-screen').classList.remove('active');
}

// ===== FILE DETAIL =====
function openFileDetail(recordOrId) {
  let record;
  if(typeof recordOrId === 'object' && recordOrId.id) {
    record = FILES_DB.find(f => f.id === recordOrId.id) || FILES_DB[0];
  } else {
    record = recordOrId;
  }
  if(!record) return;

  const hero = document.getElementById('fd-hero');
  hero.style.background = `linear-gradient(135deg, ${record.cat.color}33, ${record.cat.color}11)`;
  hero.innerHTML = `<span style="font-size:80px;filter:drop-shadow(0 4px 20px ${record.cat.color}66)">${record.cat.icon}</span>`;

  document.getElementById('fd-smart-name').textContent = record.smartName;
  document.getElementById('fd-orig-name').textContent = record.name;
  document.getElementById('fd-old-path').textContent = record.originalPath;
  document.getElementById('fd-new-path').textContent = record.newPath;
  document.getElementById('fd-category').innerHTML = `<span style="color:${record.cat.color}">${record.cat.icon} ${record.cat.name}</span>`;
  document.getElementById('fd-size').textContent = record.sizeFormatted;
  document.getElementById('fd-ocr').textContent = record.ocrScore > 0 ? `${record.ocrScore}%` : 'N/A';

  const ocrSection = document.getElementById('fd-ocr-section');
  if(record.ocrText) {
    ocrSection.style.display = 'block';
    const highlighted = record.ocrText.replace(/(\d+[.,]\d+|\‚Çπ[\d,]+|(?:HDFC|KSEB|LIC|BWSS?B|Amazon|SBI|ICICI))/g, '<span class="ocr-keyword">$1</span>');
    document.getElementById('fd-ocr-text').innerHTML = highlighted;
  } else {
    ocrSection.style.display = 'none';
  }

  const tagsEl = document.getElementById('fd-tags');
  tagsEl.innerHTML = (record.tags||[]).map(t => 
    `<span class="tag" style="background:${record.cat.color}22;color:${record.cat.color}">${t}</span>`
  ).join('');

  document.getElementById('file-detail-popup').classList.add('active');
}

function closeFileDetail() {
  document.getElementById('file-detail-popup').classList.remove('active');
}

// ===== SEARCH =====
function setSearchFilter(f, el) {
  searchFilter = f;
  document.querySelectorAll('.filter-chips .chip').forEach(c => c.classList.remove('active'));
  el.classList.add('active');
  doSearch(document.getElementById('search-input').value);
}

function doSearch(query) {
  const results = document.getElementById('search-results');
  if(!query.trim()) {
    results.innerHTML = `<div class="empty-state"><div class="empty-icon">üîç</div><div class="empty-title">Start searching</div><div class="empty-sub">Search across file names and OCR-extracted content.</div></div>`;
    return;
  }
  const q = query.toLowerCase();
  let filtered = FILES_DB.filter(f => {
    const nameMatch = f.smartName.toLowerCase().includes(q) || f.name.toLowerCase().includes(q);
    const ocrMatch = f.ocrText && f.ocrText.toLowerCase().includes(q);
    return nameMatch || ocrMatch;
  });
  if(searchFilter !== 'all') {
    const map = { bills:['electricity','water','gas'], finance:['bank','salary','invoice','receipt','tax'], medical:['medical','prescription'], identity:['identity'], images:['image','video'] };
    const cats = map[searchFilter] || [];
    if(cats.length) filtered = filtered.filter(f => cats.includes(f.cat.id));
  }

  if(!filtered.length) {
    results.innerHTML = `<div class="empty-state"><div class="empty-icon">üò∂</div><div class="empty-title">No results</div><div class="empty-sub">Try a different keyword or category filter.</div></div>`;
    return;
  }
  results.innerHTML = filtered.map((f,i) => `
    <div class="file-card" style="animation-delay:${i*0.05}s" onclick="openFileDetail({id:${f.id}})">
      <div style="position:absolute;left:0;top:0;bottom:0;width:3px;background:${f.cat.color};border-radius:3px 0 0 3px"></div>
      <div class="file-icon-wrap" style="background:${f.cat.color}22;font-size:20px">${f.cat.icon}</div>
      <div class="file-info">
        <div class="file-name">${f.smartName}</div>
        <div class="file-original">${f.name}</div>
        <div class="file-meta">
          <span class="file-badge" style="background:${f.cat.color}22;color:${f.cat.color}">${f.cat.name}</span>
        </div>
      </div>
      <div class="file-time">${timeAgo(f.time)}</div>
    </div>
  `).join('');
}

// ===== STATS CHART =====
function renderStats() {
  const counts = getCatCounts();
  const total = statsTotal;
  document.getElementById('donut-total').textContent = total;

  if(total === 0) return;

  const topCats = CATEGORIES.filter(c => (counts[c.id]||0) > 0)
    .sort((a,b) => (counts[b.id]||0)-(counts[a.id]||0))
    .slice(0,6);

  // Donut
  let offset = 0;
  const r = 70, cx = 100, cy = 100;
  const circ = 2 * Math.PI * r;
  const svg = document.getElementById('donut-svg');
  svg.innerHTML = `<circle cx="${cx}" cy="${cy}" r="${r}" fill="none" stroke="rgba(255,255,255,0.05)" stroke-width="20"/>`;

  topCats.forEach((cat, i) => {
    const pct = (counts[cat.id]||0) / total;
    const dash = pct * circ;
    const el = document.createElementNS('http://www.w3.org/2000/svg','circle');
    el.setAttribute('cx', cx); el.setAttribute('cy', cy); el.setAttribute('r', r);
    el.setAttribute('fill','none');
    el.setAttribute('stroke', cat.color);
    el.setAttribute('stroke-width','20');
    el.setAttribute('stroke-dasharray', `0 ${circ}`);
    el.setAttribute('stroke-dashoffset', -offset * circ);
    el.setAttribute('stroke-linecap','round');
    el.style.transition = 'stroke-dasharray 1s ease ' + (i*0.1) + 's';
    svg.appendChild(el);
    setTimeout(() => el.setAttribute('stroke-dasharray', `${dash} ${circ - dash}`), 50);
    offset += pct;
  });

  document.getElementById('donut-legend').innerHTML = topCats.map(cat => `
    <div class="legend-item"><div class="legend-dot" style="background:${cat.color}"></div>${cat.name}: ${counts[cat.id]}</div>
  `).join('');

  // Bar chart
  const barChart = document.getElementById('bar-chart');
  const maxCount = Math.max(...topCats.map(c => counts[c.id]||0));
  barChart.innerHTML = topCats.map((cat, i) => {
    const pct = ((counts[cat.id]||0) / maxCount * 100).toFixed(0);
    return `
      <div class="bar-row">
        <div class="bar-label">${cat.icon} ${cat.name.split(' ')[0]}</div>
        <div class="bar-track">
          <div class="bar-fill" id="bar-${i}" style="background:${cat.color};width:0%"></div>
        </div>
        <div class="bar-count">${counts[cat.id]||0}</div>
      </div>
    `;
  }).join('');

  setTimeout(() => {
    topCats.forEach((cat, i) => {
      const pct = ((counts[cat.id]||0) / maxCount * 100).toFixed(0);
      const bar = document.getElementById(`bar-${i}`);
      if(bar) bar.style.width = pct + '%';
    });
  }, 100);
}

// ===== MANUAL SCAN =====
function triggerManualScan() {
  if(simIndex < simQueue.length) {
    processNewFile(simQueue[simIndex++]);
    if(simIndex < simQueue.length) scheduleNextFile();
  } else {
    showToast('‚úÖ','All files organized','Your storage is fully organized!');
  }
}

// ===== TOAST =====
let toastTimer;
function showToast(icon, title, sub, showUndo=true) {
  const toast = document.getElementById('toast');
  document.getElementById('toast-icon').textContent = icon;
  document.getElementById('toast-title').textContent = title;
  document.getElementById('toast-sub').textContent = sub;
  document.getElementById('toast-undo').style.display = showUndo ? 'block' : 'none';
  toast.classList.add('show');
  clearTimeout(toastTimer);
  toastTimer = setTimeout(() => toast.classList.remove('show'), 4000);
}

function undoLast() {
  if(lastOrganized) {
    FILES_DB.shift();
    statsTotal = Math.max(0, statsTotal-1);
    statsToday = Math.max(0, statsToday-1);
    animateNum('stat-total', statsTotal);
    animateNum('stat-today', statsToday);
    renderCatMini();
    const list = document.getElementById('activity-list');
    const first = list.querySelector('.file-card');
    if(first) first.remove();
    showToast('‚Ü©Ô∏è','Undo successful',`"${lastOrganized.smartName}" moved back.`, false);
    lastOrganized = null;
  }
}

// ===== TOGGLE =====
function toggleSwitch(el) {
  el.classList.toggle('on');
}

// ===== UTILS =====
function timeAgo(date) {
  const s = Math.floor((Date.now() - new Date(date).getTime()) / 1000);
  if(s < 10) return 'just now';
  if(s < 60) return `${s}s ago`;
  if(s < 3600) return `${Math.floor(s/60)}m ago`;
  return `${Math.floor(s/3600)}h ago`;
}

// Update times every 30s
setInterval(() => {
  document.querySelectorAll('.file-time').forEach(el => {
    // Times update passively
  });
}, 30000);
</script>
</body>
</html>
